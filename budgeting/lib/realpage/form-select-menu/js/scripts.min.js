angular.module("rpFormSelectMenu",[]),function(a){"use strict";function b(a){return function(){function b(){c.events=e,c.valKey=g,c.nameKey=h,e.change.subscribe(c.updateValue)}var c,d=[],e={},f=[],g="value",h="name";return e.change=a(),c={options:[],selected:"",labelText:"",updateLabel:!0},c.setNameKey=function(a){return h=c.nameKey=a,c},c.setValKey=function(a){return g=c.valKey=a,c},c.reset=function(){c.resetValue().resetState(),c.selected=c.options[0]},c.resetState=function(){for(var a in c.state)c.state[a]=!1},c.isValidOption=function(a){return void 0!==a[h]&&void 0!==a[g]},c.isDuplicateOption=function(a){var b=d.contains(a[h]),c=f.contains(a[g]);return b||c},c.setOptions=function(a){return a&&a.forEach&&a.forEach(c.addOption),c},c.addOption=function(a){var b=c.isValidOption(a)&&!c.isDuplicateOption(a);return b&&(c.options.push(a),d.push(a[h]),f.push(a[g]),1==c.options.length&&(c.selected=c.options[0])),c},c.removeOption=function(a){var b=d.indexOf(a[h]);return b!=-1&&(d.remove(b),f.remove(b),c.options.remove(b),0===b&&(c.selected=c.options[0])),c},c.flushOptions=function(){return d.flush(),f.flush(),c.selected="",c.options.flush(),c},c.selectOption=function(a){var b=d.indexOf(a[h]),e=f.indexOf(a[g]);return b!=-1?c.selected=c.options[b]:e!=-1&&(c.selected=c.options[e]),c},c.selectOptionIndex=function(a){return a<c.options.length&&a>-1&&(c.selected=c.options[a]),c},c.resetValue=function(){return c.form&&c.formKey&&(c.form[c.formKey]=""),c},c.updateValue=function(a){c.form&&c.formKey&&(c.form[c.formKey]=a[g])},c.destroy=function(){var a=this;a=null,d=null,f=null},b(),c}}a.module("rpFormSelectMenu").factory("rpSelectMenuModel",["eventStream",b])}(angular),function(a){"use strict";function b(){var b={};return b.wrap=function(){var b="<div class='rp-select-menu'></div>";return a.element(b)},b.inner=function(b){var c="<div class='rp-select-menu-inner' ng-class='"+b+".getState()'><span class='rp-select-menu-value'>{{"+b+".getDisplayText()}}</span><span ng-if='"+b+".errorMsg.required' class='error-msg required'>{{"+b+".errorMsg.required}}</span><span ng-if='"+b+".errorMsg.min' class='error-msg min'>{{"+b+".errorMsg.min}}</span><span ng-if='"+b+".errorMsg.max' class='error-msg max'>{{"+b+".errorMsg.max}}</span><span ng-if='"+b+".errorMsg.pattern' class='error-msg pattern'>{{"+b+".errorMsg.pattern}}</span></div>";return a.element(c)},b}a.module("rpFormSelectMenu").factory("rpSelectMenuHtml",[b])}(angular),function(a,b){"use strict";function c(c,d,e){function f(f,h,i,j){function k(){r.state=s,o=i.rpOptionNameKey||"name",r.errorMsg=f.$eval(i.rpErrorMsg),p=i.rpOptionValueKey||"value",r.exposeInstance().decorate().bindEvents().storeData()}g++;var l,m,n,o,p,q,r={},s={},t="blur.rpFormSelect"+g,u="focus.rpFormSelect"+g;r.setInstanceName=function(){return q=i.rpInstanceName?i.rpInstanceName:"rpFormSelect"+g,r},r.exposeInstance=function(){return r.setInstanceName(),f[q]=r,r},r.decorate=function(){var a=e.wrap(),b=e.inner(q);return i.rpWrapperClass&&a.addClass(i.rpWrapperClass),d(a)(f),d(b)(f),l=h.wrap(a).parent().append(b),r},r.bindEvents=function(){return h.on(u,r.onFocus),r},r.storeData=function(){return m=r.getValue(),n=r.getSelectedName(),r},r.onFocus=function(){f.$apply(function(){s.focus=!0,l.addClass("focus"),h.on(t,r.onBlur)})},r.onBlur=function(){f.$apply(function(){h.off(t),s.focus=!1,l.removeClass("focus"),s.touched||(s.touched=!0)})},r.reset=function(){var a=c(i.ngModel);f.$apply(function(){r.state=s={},a.assign(f,m)})},r.getOptions=function(){return f.$eval(i.rpSelectOptions)},r.getValue=function(){return f.$eval(i.ngModel)},r.getState=function(){return j&&a.extend(s,{error:j.$invalid,touched:j.$touched,required:j.$required}),s},r.getDisplayText=function(){return f.$eval(i.rpUpdateDisplayText)?r.getSelectedName():n},r.getSelectedName=function(){var a,c=r.getValue(),d=r.getOptions().options;return c=c===b?"":c,d.forEach(function(b){c===b[p]&&(a=b[o])}),a},k()}var g=0;return{link:f,restrict:"C",require:"ngModel"}}a.module("rpFormSelectMenu").directive("rpFormSelect",["$parse","$compile","rpSelectMenuHtml",c])}(angular);
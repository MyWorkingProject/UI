angular.module("rpWorkspaces",[]),angular.module("rpWorkspaces").run(["$templateCache",function(a){a.put("realpage/workspaces/templates/workspaces.html",'<div class="rp-workspaces scroll-workspace"><!-- <rp-busy-indicator model="busyModel">\n    </rp-busy-indicator>\n    --><div class="rp-workspaces-list" ng-class="listCtrl.list.state"><rp-toggle model="listCtrl.list.state.active" class="rp-workspaces-list-toggle header-text ft-medium ft-s-18 ft-track-20" options="{\n                bodyToggle: true,\n                activeText: \'Workspaces\',\n                defaultText: \'Workspaces\',\n                defaultIconClass: \'rp-icon-angle-up\',\n                activeIconClass: \'rp-icon-angle-down\'\n            }"></rp-toggle><ul rp-stop-event="click" class="rp-workspaces-list-wrap dropdown-menu dropdown-menu-width ft-form"><li class="rp-workspaces-list-item" ng-if="!workspace.isPlaceholder()" ng-repeat="workspace in model.list track by workspace.id"><label for="{{::workspace.id}}" class="rp-workspaces-list-item-label md-check dark-bluebox">{{::workspace.getTitle()}} <input type="checkbox" id="{{::workspace.id}}" ng-true-value="true" ng-false-value="false" class="ui-check" ng-change="model.save()" ng-model="workspace.data().isActive"> <i class="primary"></i></label></li></ul></div><rp-daterangepicker ng-if="model.isDateSensitive()" rp-model="workspaces.dateRange" class="inline workspaces-date-range" config="workspaces.daterangepickerConfig"></rp-daterangepicker><div class="rp-workspaces-border-b b-b b-b-neutral-06"></div><span class="scroll-left rp-icon-angle-right text-neutral-04" ng-click="workspaceScroll.left()" ng-class="workspaceScroll.state.scrollLeft"></span> <span class="scroll-right rp-icon-angle-left text-neutral-04" ng-click="workspaceScroll.right()" ng-class="workspaceScroll.state.scrollRight"></span><div class="rp-workspaces-screen-wrap"><div class="rp-workspaces-screen rp-draggable-wrap"><div class="rp-workspaces-slider"><div ng-show="workspace.isActive()" rp-droppable="{{::workspace.id}}" rp-draggable="{{::workspace.id}}" rp-drag="workspaces.drag(workspace)" rp-drag-enabled="workspace.allowDrag" rp-drag-end="workspaces.endDrag(workspace)" rp-drag-start="workspaces.startDrag(workspace)" class="rp-workspace {{workspace.data().className}}" ng-repeat="workspace in model.list track by workspace.id"><div class="rp-workspaces-box"><div class="box-workspaces-header b-b b-b-neutral-04"><h3 class="text-primary ft-medium ft-s-16 ft-track-5 text-u-c">{{::workspace.getTitle()}}</h3></div><ul ng-mouseout="workspace.enableDrag()" ng-mouseover="workspace.disableDrag()" rp-touchend="workspace.enableDrag()" rp-touchstart="workspace.disableDrag()" class="metrics details-{{workspace.metricCount()}}"><li ng-click="workspace.goTo(detail)" ng-repeat="detail in workspace.data().details" class="{{::workspace.getListClass()}} {{$even ? \' pad-left\' : \' pad-right\'}}"><span class="metric text-{{detail.status}}">{{::detail.metric}}</span> <span class="desc" title="{{::workspace.getDesc(detail)}}">{{::workspace.getDesc(detail)}}</span></li></ul></div></div></div></div></div></div>')}]),function(a){"use strict";function b(b){var c={};return c.config={dateSensitive:!0},c.get=a.noop,c.save=a.noop,c.setConfig=function(b){return a.extend(c.config,b),c.configGet().configSave(),c},c.configGet=function(){var a,d,e;return a=c.config.dateSensitive,d=c.config.url+(a?"/:startDate/:endDate":""),e={endDate:14452308e5,startDate:14462676e5},c.get=b(d,a?e:{}).get,c},c.configSave=function(){var a,d;return d={save:{method:"PUT"}},a="/api/core/common/workspace",c.save=b(a,{},d).save,c},c.isDateSensitive=function(){return c.config.dateSensitive},c}a.module("rpWorkspaces").factory("workspaces",["$resource",b])}(angular),function(a){"use strict";function b(a){var b={};return b.links={},b.setLinks=function(a){a&&(b.links=a)},b.goTo=function(c){b.links[c]&&(a.location.href=b.links[c])},b}a.module("rpWorkspaces").factory("workspacesLinks",["$window",b])}(angular),function(a){"use strict";function b(b,c,d,e){var f={};return f.config={url:"",links:{},appName:"lrc",dateSensitive:!0,translate:{}},f.setConfig=function(g){a.extend(f.config,g),b.setConfig(f.config),c.setLinks(f.config.links),d.setAppName(f.config.appName),e.set(g.translator)},f}a.module("rpWorkspaces").factory("workspacesConfig",["workspaces","workspacesLinks","workspacesDateRange","workspaceTranslate",b])}(angular),function(a){"use strict";function b(a){var b={};return b.events=a(),b.state={scrollLeft:{hide:!1},scrollRight:{hide:!0}},b.getState=function(){return b.state},b.reset=function(){return b.state.scrollLeft.hide=!1,b.state.scrollRight.hide=!0,b},b.publish=function(a){return b.events.publish(a),b},b.subscribe=function(a){return b.events.subscribe(a),b},b.hideScrollLeft=function(a){return b.state.scrollLeft.hide=a,b},b.hideScrollRight=function(a){return b.state.scrollRight.hide=a,b},b}a.module("rpWorkspaces").factory("workspaceScrollModel",["eventStream",b])}(angular),function(a){"use strict";function b(a,b,c){var d=1;return function(e){var f={};return f.id=e||"workspace"+d++,f.allowDrag=!0,f._data={details:[],isActive:!1},f.data=function(a){return a?(f._data=a,f):f._data},f.getID=function(){return f.id},f.enableDrag=function(){f.allowDrag=!0},f.disableDrag=function(){f.allowDrag=!1},f.state=function(){return{active:f._data.isActive}},f.isActive=function(){return f._data.isActive},f.isPlaceholder=function(){return"placeholder"==f._data.className},f.is=function(a){return f.id===a.id},f.metricCount=function(){return f._data.details.length},f.getTitle=function(){return c.translate(f._data.guid+"-title")},f.setDirty=function(){return f._data.dirtyBit=!0,f},f.goTo=function(b){var d="";d=c.translate(b.guid+"-desc"),f.setCookie(d),a.goTo(f._data.guid)},f.setCookie=function(a){b.create("WorkspaceLink",a,1)},f.setSequence=function(a){return f._data.sequence=a,f},f.getDesc=function(a){var b,d;return d=c.translate(a.guid+"-desc"),b=""===a.description?"":": "+a.description,b=d+b},f.getListClass=function(){var a=f.metricCount(),b="";switch(a){case 1:b="col-xs-12";break;case 2:b="col-xs-6";break;case 3:b="col-xs-12";break;case 4:b="col-xs-6";break;case 5:b="col-xs-6";break;case 6:b="col-xs-6";break;default:b="col-xs-6"}return b},f}}a.module("rpWorkspaces").factory("workspaceModel",["workspacesLinks","rpCookie","workspaceTranslate",b])}(angular),function(a){"use strict";function b(a,b){var c={};return c.id="workspacesDateRange",c.setAppName=function(a){return c.id=a+"WorkspacesDateRange",c},c.get=function(d){var e={};if(b.has(c.id)){var f=b.get(c.id);e.endDate=a(f.endDate,"x"),e.startDate=a(f.startDate,"x")}else e.endDate=a().endOf("month"),e.startDate=a().startOf("day");return d&&(e={endDate:e.endDate.format(d),startDate:e.startDate.format(d)}),e},c.set=function(a){b.set(c.id,a)},c}a.module("rpWorkspaces").factory("workspacesDateRange",["moment","rpSessionStorage",b])}(angular),function(a,b){"use strict";function c(a,c){var d={};return d.list=[],d._placeholderIndex=b,d._placeholder=c("placeholder").data({title:"",details:[],isActive:!0,className:"placeholder"}),d.isDateSensitive=function(){return a.isDateSensitive()},d.load=function(b){return d.flush(),b?a.get(b,d.update).$promise:a.get(d.update).$promise},d.update=function(a){a.records=a.records||[],a.records.forEach(d.addToList)},d.addToList=function(a){var b=c().data(a);d.list.push(b)},d.getIndex=function(a){var b;return d.list.forEach(function(c,d){a.is(c)&&(b=d)}),b},d.insertWorkspaceAt=function(a,b){return d.list.insertAt(a,b),d},d.removeWorkspace=function(a){return d.list=d.list.filter(function(b){return!a.is(b)}),d},d.eachWorkspace=function(a){return d.list.forEach(a),d},d.insertPlaceholderAt=function(a){d._placeholderIndex=a,d.insertWorkspaceAt(a,d._placeholder)},d.removePlaceholder=function(){return d.removeWorkspace(d._placeholder),d},d.replacePlaceholderWith=function(a){var b=d._placeholderIndex,c=d.getIndex(a),e=c<b?b-1:b;return d.removeWorkspace(a).removePlaceholder().insertWorkspaceAt(e,a),d},d.flush=function(){d.list.flush()},d.updatedList=function(){var a=[];return d.list.forEach(function(b,c){b.setSequence(c+1).setDirty(),a.push(b.data())}),{workspaceList:a}},d.save=function(b){var c=d.updatedList();return a.save(b,c).$promise},d}a.module("rpWorkspaces").factory("workspacesModel",["workspaces","workspaceModel",c])}(angular),function(a){"use strict";function b(){var b={translator:{translate:a.noop}};return b.set=function(a){b.translator=a},b.translate=function(a){return b.translator.translate(a)},b}a.module("rpWorkspaces").factory("workspaceTranslate",[b])}(angular),function(a,b){"use strict";function c(a,c,d,e,f,g,h,i){var j=this;j.busy=!1,j.activeIndex=b,j.activeWorkspace=b,j.init=function(){a.model=d,a.busyModel=h(),d.isDateSensitive()&&j.initDaterangePicker(),c.isReady()&&j.updateModel(),a.$on("$destroy",j.destroy),j.sessionWatch=c.subscribe("update",j.updateModel)},j.initDaterangePicker=function(){j.dateRange=e.get(),j.daterangepickerConfig=i({onChange:j.onDateRangeChange})},j.onDateRangeChange=function(a){e.set(a),j.updateModel()},j.updateModel=function(){if(!j.busy){j.busy=!0;var b=e.get("x");a.busyModel.busy(),d.isDateSensitive()?d.load(b).then(j.afterUpdate):d.load().then(j.afterUpdate)}},j.afterUpdate=function(){a.busyModel.off(),j.busy=!1},j.startDrag=function(a){j.activeIndex=d.getIndex(a),d.insertPlaceholderAt(j.activeIndex)},j.drag=function(a){j.activeWorkspace=a,d.eachWorkspace(j.movePlaceholder)},j.movePlaceholder=function(a,b){if(!a.is(j.activeWorkspace)&&!a.isPlaceholder()){var c=j.activeWorkspace.getID(),e=f(c).dragPoint();g(a.getID()).contains(e)&&b!=j.activeIndex&&(j.activeIndex=b,d.removePlaceholder().insertPlaceholderAt(b))}},j.endDrag=function(a){d.replacePlaceholderWith(a).save()},j.destroy=function(){d.flush(),j.sessionWatch()},j.init()}a.module("rpWorkspaces").controller("WorkspacesCtrl",["$scope","sessionInfo","workspacesModel","workspacesDateRange","rpDraggableSvc","rpDroppableSvc","rpBusyIndicatorModel","rpDaterangepickerConfig",c])}(angular),function(a){"use strict";function b(a,b){function c(c,d,e){var f,g={};g.init=function(){c.workspacesScreen=g,a.reset().subscribe(g.eventHandler),d.on("scroll",g.onScroll)},g.onScroll=function(){b.cancel(f),f=b(g.updateControls,200)},g.updateControls=function(){var b=g.getStops(),c=g.getScroll();a.hideScrollRight(0===c),a.hideScrollLeft(c>=b[b.length-1]-2)},g.eventHandler=function(a){g[a]()},g.sliderWidth=function(){return d.children(".rp-workspaces-slider").outerWidth()},g.slideWidth=function(){return d.children(".rp-workspaces-slider").children(".rp-workspace").outerWidth(!0)},g.screenWidth=function(){return d.width()},g.getScroll=function(){return d.scrollLeft()},g.getStep=function(){return g.slideWidth()*Math.floor(g.screenWidth()/g.slideWidth())},g.getStops=function(){for(var a=0,b=[],c=g.getStep(),d=g.sliderWidth()-g.screenWidth();a<d;)b.push(a),a+=c,a>d&&(a=d,b.push(a));return b},g.scrollLeft=function(){var a,b=g.getStops(),c=g.getScroll();b.forEach(function(b){!a&&b>c&&(a=b)}),g.animate(a)},g.scrollRight=function(){var a,b=g.getScroll(),c=g.getStops().reverse();c.forEach(function(c){!a&&c<b&&(a=c)}),g.animate(a)},g.animate=function(a){d.animate({scrollLeft:a},200)},g.init()}return{link:c,restrict:"C"}}a.module("rpWorkspaces").directive("rpWorkspacesScreen",["workspaceScrollModel","timeout",b])}(angular),function(a){"use strict";function b(a){function b(b,c,d){var e={};e.state=a.getState(),e.init=function(){b.workspaceScroll=e},e.left=function(){a.publish("scrollLeft")},e.right=function(){a.publish("scrollRight")},e.init()}return{link:b,restrict:"C"}}a.module("rpWorkspaces").directive("scrollWorkspace",["workspaceScrollModel",b])}(angular),function(a){"use strict";function b(){function a(a,b,c){}return{scope:{},link:a,restrict:"E",replace:!0,controller:"WorkspacesCtrl as workspaces",templateUrl:"realpage/workspaces/templates/workspaces.html"}}a.module("rpWorkspaces").directive("rpWorkspaces",[b])}(angular);
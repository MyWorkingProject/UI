angular.module("rpUserMessages",[]),function(a){"use strict";function b(a){a.put(d,c)}var c,d;d="templates/realpage/common/user-messages/user-messages.html",c="<div class='user-messages' ng-class='model.state'><div class='message {{::msg.data.statusType}}' ng-repeat='msg in model.messages'><div class='message-icon-{{::msg.data.statusType}}'></div><div class='heading'><div class='title'>{{::msg.translate('title', msg.data)}}</div><div class='date'>{{::msg.data.msgStartDate}}</div></div><div class='message-content' toggle-message-content='msg.data'><any ng-bind-html='msg.translate(\"actionValue\", msg.data) | htmlUnsafe'></any></div><div class='action' ng-if='msg.data.actionType'><div ng-switch='msg.data.actionType'><div ng-switch-when='accept'><input type='checkbox' id='checkbox{{$index}}' class='rp-form-checkbox' ng-model='msg.data.acceptBit' ng-change='model.updateActivityLog(msg.data.msgID)'/><label class='checkbox-label' for='checkbox{{$index}}' >{{::msg.translate('actionText', msg.data)}}</label></div><div ng-switch-when='link'><a href='{{::msg.data.actionUrl}}'>{{::msg.translate('actionText', msg.data)}}</a></div></div></div></div></div>",a.module("rpUserMessages").run(["$templateCache",b])}(angular),function(a){"use strict";function b(a,b){function c(){var b="/api/core/common/omsmessage/user/messages/"+e;return a(b).get}function d(){var b,c={},d="/api/core/common/OMSMessage/UserLog/:msgID/:msgulActionID";return b={recordActivity:{method:"POST",params:{msgID:"@msgID",msgulActionID:2}}},a(d,c,b).recordActivity}var e=b.read("LANG")||"en-us";return{get:c(),recordActivity:d()}}a.module("rpUserMessages").factory("userMessages",["$resource","rpCookie",b])}(angular),function(a){"use strict";function b(a,b,c){var d={"critical-messages":!1},e={messageID:0},f={state:d,messages:[],changePasswordUrl:"/ui/signin/#/change-password"};return f.text={viewAllMessages:"view all messages"},f.load=function(){return a.get(f.update)},f.update=function(a){return a&&a.omsMessageUserList&&a.omsMessageUserList.forEach&&a.omsMessageUserList.forEach(function(a){var c=f.updateMsgData(a);f.messages.push(b().init(c))}),f},f.updateMsgData=function(a){return"change-password"===a.actionName&&(a.actionUrl=f.changePasswordUrl,e.messageID=a.msgID,c.set("changePasswordMessageData",e)),a},f.showAllMessages=function(){return d["critical-messages"]=!1,f},f.showCriticalMessages=function(){return d["critical-messages"]=!0,f},f.getMessagesCount=function(){return f.messages.length},f.hasMessages=function(){return f.messages.length>0},f.getCriticalMessagesCount=function(){var a=0;return f.messages.forEach(function(b){b.isCritical()&&a++}),a},f.hasCriticalMessages=function(){return f.getCriticalMessagesCount()>0},f.reset=function(){f.messages.flush(),d["critical-messages"]=!1},f.updateActivityLog=function(b){var c={msgID:b,msgulActionID:2};a.recordActivity(c,{})},f}a.module("rpUserMessages").factory("userMessagesModel",["userMessages","userMessageModel","rpSessionStorage",b])}(angular),function(a){"use strict";function b(a,b){return function(){var c={};return c.data={},c.translate=a("userMessages").translate,c.init=function(a){return c.data=a,c.updateChangePassword(a),c},c.isCritical=function(){return"critical"===c.data.statusType},c.updateChangePassword=function(a){if("change-password"==a.actionName){var c={};c.messageID=c.msgID,a.actionUrl="/ui/signin/#/change-password",b.set("changePasswordMessageData",c)}return a},c.updateMessageData=function(a){var b=a;return a&&(a=c.translate("messageData",a)),b},c}}a.module("rpUserMessages").factory("userMessageModel",["appLangTranslate","rpSessionStorage",b])}(angular),function(a,b){"use strict";function c(a){function c(c,d,e){var f,g={};g.init=function(){c.dir=g,a.load(),c.model=a,f=c.$on("$destroy",g.destroy)},g.showAllMessages=function(){a.showAllMessages()},g.destroy=function(){f(),a.reset(),c.model=b},g.init()}return{scope:{},link:c,restrict:"E",replace:!0,templateUrl:"templates/realpage/common/user-messages/user-messages.html"}}a.module("rpUserMessages").directive("userMessages",["userMessagesModel",c])}(angular),function(a){"use strict";function b(b,c,d,e){function f(f,h,i){var j={isOpen:!1,toggleText:"readMore",instName:"toggleMessageContent"+g++,translate:c("common").translate,click:e.clickEvent("toggleMessageContent")};j.init=function(){f[j.instName]=j,j.watch=f.$watch(j.hasHeight,j.setup)},j.getToggleElem=function(){var c='<span class="toggle-message-content">{{'+j.instName+".translate("+j.instName+".toggleText)}}</span>",d=a.element(c);return b(d)(f)},j.setup=function(a){if(a&&j.watch(),j.enabled()){j.closedHeight=65,j.openHeight=h.height();var b=j.getToggleElem();h.append(b).css("height",j.closedHeight).addClass("toggle-enabled closed"),b.on(j.click,j.onClick)}},j.onClick=function(){f.$apply(j.toggleContent)},j.toggleContent=function(){j.isOpen?(j.isOpen=!1,h.addClass("closed"),j.openHeight=h.height(),h.height(j.openHeight),h.height(j.closedHeight),j.toggleText="readMore"):(j.isOpen=!0,h.height(j.openHeight),h.removeClass("closed"),d(j.setAutoHeight,210),j.toggleText="readLess")},j.setAutoHeight=function(){h.height("")},j.getData=function(){return f.$eval(i.toggleMessageContent)},j.hasHeight=function(){return h.outerHeight()>75},j.enabled=function(){return!j.getData().showFullMessage&&j.hasHeight()},j.init()}var g=1;return{link:f,restrict:"A"}}a.module("rpUserMessages").directive("toggleMessageContent",["$compile","appLangTranslate","timeout","deviceInfoSvc",b])}(angular);